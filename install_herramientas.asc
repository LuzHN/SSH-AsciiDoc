:imagesdir: images


=== **Open-SSH**
En nuestra terminal, ejecutamos el siguiente comando:

[source,bash]
----
sudo apt-get install openssh-server -y
----

image::1_1_install_ssh.png[align="center"]


Al finalizar la instalacion, revisamos el estado de SSH:

[source,bash]
----
sudo systemctl status ssh
----

image::1_2_ssh_status.png[align="center"]

. . . y listo!


=== **Ngrok**

Para efectos practicos, decidimos utilizar esta herramienta para permitir acceso remoto a la PC que vamos a configurar.

** **Opcion 1: Descarga de la pagina Oficial** 

Damos click en el siguiente link para descargar el programa.

https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip

Luego descomprimimos el archivo

[source,bash]
----
unzip ngrok.zip
----

...y por ahora estamos bien!



** **Opcion 2: Descarga por Snap** 

Abrimos la En nuestra terminal, ejecutamos el siguiente comando:

[source,bash]
----
sudo snap install ngrok
----

Comprobamos la instalacion del paquete 

image::1_3_ngrok.png[align="center"]



** **Configurar Ngrok**

Debemos entrar a la pagina oficial de Ngrok, y crear una cuenta.

https://ngrok.com/

image::1_4_crear_cuenta_ngrok.png[align="center"]

Luego accedemos a nuestro dashboard, y copiamos nuestra auth token

image::1_5_authtoken_ngrok.png[align="center"]


Ahora necesitamos guardar esta authtoken en nuestra instalacion.

[source,bash]
----
#Si se escogio la primera opcion de instalacion
./<directorio_de_descarga>/ngrok authtoken <nuestro_authtoken>

#Si se escogio la segunda opcion
ngrok authtoken <nuestro_authtoken>
----
...y listo!

=== **Google Authentication**

Instalamos el modulo Google Authenticator PAM : 

[source,bash]
----
sudo apt install libpam-google-authenticator
----

image::1_6_install_googleauth.png[align="center"]

Luego debemos modificar el archivo **/etc/pam.d/sshd** :

[source,bash]
----
sudo nano /etc/pam.d/sshd
----

y agregamos la siguiente linea:

[source,txt]
----
auth required pam_google_authenticator.so
----

image::1_7_ssh_conf.png[align="center"]

Luego reiniciamos el servicio de sshd.

[source,txt]
----
sudo systemctl restart sshd.service
----

Modificamos el archivo **/etc/ssh/sshd_config** y cambiamos *_ChallengeResponseAuthentication no_* a *_ChallengeResponseAuthentication yes_*.

[source,bash]
----
sudo nano /etc/ssh/sshd_config
----

image::1_8_sshconf.png[align="center"]

Ya estamos listos para el ejercicio! 

